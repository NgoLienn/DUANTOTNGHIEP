<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head th:replace="~{zlayout/fragments :: html_head}"></head>

<link rel="stylesheet" href="/assets/css_main/order.css">

<body>
    <div th:replace="~{zlayout/loadAndCartSmall :: loader}"></div>

    <div th:replace="~{zlayout/loadAndCartSmall :: cartSmall}"></div>

    <div class="containerr ">
        <div class="image_big">
            <div class="image-one"></div>
            <div class="image-three"></div>
            <div class="image-two">
                <img src="/assets/images/leaves.png" alt="leaves.png" class="food2">
                <nav class="navb navbar-expand-lg navbar-light bg-light" th:replace="zlayout/navbar :: menu"></nav>

                <header class="banner-big">
                    <div class="img-blur ">
                        <!-- <img src="assets/images/food5.png" class="anh1" alt=""> -->
                    </div>
                    <div class="wraper">
                        <aside class="">
                            <div class="container-fluid py-4 mt-3">
                                <span class="tttk text-uppercase"><b> Thông Tin Đơn Hàng</b></span>
                                <div class="row mt-3">
                                    <div class="col-md-auto">
                                        <div class="tab-pane tab-content" id="nav-tabContent">
                                            <section class=" tab-profile" id="nav-profile">
                                                <span class="h5 px-2">Đơn Mua</span>
                                                <div class="container-fluid py-4 mt-3">
                                                    <div class="product-container table">
                                                        <div class="product-row header">
                                                            <div class="product-cell">Sản phẩm</div>
                                                            <div class="product-cell">Size</div>
                                                            <div class="product-cell px-4">Đơn giá</div>
                                                            <div class="product-cell px-5">Số lượng</div>
                                                            <div class="product-cell">Thành tiền</div>
                                                        </div>

                                                        <div class="product-row">
                                                            <img src="/assets/images/bglogin.jpg" class="img-cell"
                                                                alt="prod_pm">
                                                            <div class="product-cell ">:M</div>
                                                            <div class="product-cell ">100.000₫</div>
                                                            <div class="product-cell ">2</div>
                                                            <div class="product-cell">200.000₫</div>
                                                        </div>
                                                    </div>
                                                    <div class="d-flex gap-3">
                                                        <button type="submit"
                                                            class="btn btn-danger d-flex mt-4 p-2 button-huy">Hủy Đơn
                                                        </button>
                                                        <button type="submit"
                                                            class="btn btn-primary d-flex mt-4 p-2 button-star"
                                                            data-bs-toggle="modal" data-bs-target="#staticBackdrop">Đánh
                                                            Giá
                                                        </button>
                                                    </div>
                                                </div>
                                                <div class="container-fluid py-4 mt-3">
                                                    <div class="product-container table">
                                                        <div class="product-row header">
                                                            <div class="product-cell">Sản phẩm</div>
                                                            <div class="product-cell">Size</div>
                                                            <div class="product-cell px-4">Đơn giá</div>
                                                            <div class="product-cell px-5">Số lượng</div>
                                                            <div class="product-cell">Thành tiền</div>
                                                        </div>

                                                        <div class="product-row">
                                                            <img src="/assets/images/bglogin.jpg" class="img-cell"
                                                                alt="prod_pm">
                                                            <div class="product-cell ">:M</div>
                                                            <div class="product-cell ">100.000₫</div>
                                                            <div class="product-cell ">2</div>
                                                            <div class="product-cell">200.000₫</div>
                                                        </div>
                                                    </div>
                                                    <div class="d-flex gap-3">
                                                        <button type="submit"
                                                            class="btn btn-danger d-flex mt-4 p-2 button-huy">Hủy Đơn
                                                        </button>
                                                        <button type="submit"
                                                            class="btn btn-primary d-flex mt-4 p-2 button-star"
                                                            data-bs-toggle="modal" data-bs-target="#staticBackdrop">Đánh
                                                            Giá
                                                        </button>
                                                    </div>
                                                </div>
                                                <div class="container-fluid py-4 mt-3">
                                                    <div class="product-container table">
                                                        <div class="product-row header">
                                                            <div class="product-cell">Sản phẩm</div>
                                                            <div class="product-cell">Size</div>
                                                            <div class="product-cell px-4">Đơn giá</div>
                                                            <div class="product-cell px-5">Số lượng</div>
                                                            <div class="product-cell">Thành tiền</div>
                                                        </div>

                                                        <div class="product-row">
                                                            <img src="/assets/images/bglogin.jpg" class="img-cell"
                                                                alt="prod_pm">
                                                            <div class="product-cell ">:M</div>
                                                            <div class="product-cell ">100.000₫</div>
                                                            <div class="product-cell ">2</div>
                                                            <div class="product-cell">200.000₫</div>
                                                        </div>
                                                    </div>
                                                    <div class="d-flex gap-3">
                                                        <button type="submit"
                                                            class="btn btn-danger d-flex mt-4 p-2 button-huy">Hủy Đơn
                                                        </button>
                                                        <button type="submit"
                                                            class="btn btn-primary d-flex mt-4 p-2 button-star"
                                                            data-bs-toggle="modal" data-bs-target="#staticBackdrop">Đánh
                                                            Giá
                                                        </button>
                                                    </div>
                                                </div>
                                                <!-- đánh giá -->
                                                <!-- Modal -->
                                                <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static"
                                                    data-bs-keyboard="true" tabindex="1"
                                                    aria-labelledby="staticBackdropLabel" aria-hidden="true">
                                                    <div class="modal-dialog modal-dialog-centered">
                                                        <div class="modal-content">
                                                            <div class="modal-header">
                                                                <h1 class="modal-title fs-5" id="staticBackdropLabel">
                                                                    Đánh Giá</h1>
                                                                <button type="button" class="btn-close"
                                                                    data-bs-dismiss="modal" aria-label="Close">
                                                                </button>
                                                            </div>
                                                            <form action="/user/order#modal-body" id="modal-an">
                                                                <div class="modal-body" id="modal-body">
                                                                    <div
                                                                        class="rating-container d-flex align-items-center justify-content-center">
                                                                        <div class="star" data-rating="1">★</div>
                                                                        <div class="star" data-rating="2">★</div>
                                                                        <div class="star" data-rating="3">★</div>
                                                                        <div class="star" data-rating="4">★</div>
                                                                        <div class="star" data-rating="5">★</div>
                                                                        &nbsp;&nbsp;&nbsp;
                                                                        <div class="rating-count">0</div>
                                                                    </div>
                                                                    <div class="evaluate text-center"
                                                                        style="margin-top: 3px;">
                                                                        <div id="percentage-display"
                                                                            style="color: rgb(255, 111, 0);">Bạn đã đánh
                                                                            giá 0%
                                                                        </div>
                                                                    </div>

                                                                    <textarea name="danhgiasp" id="danhgiasp" cols="56"
                                                                        rows="5"
                                                                        placeholder=" Hãy chĩa sẻ những đều bạn thích về sản phẩm này với người khác nhé!"
                                                                        style="border: 1px solid gray; margin-top: 30px; border-radius: 10px; outline: none; text-align: start; caret-color: rgb(255, 0, 0);
                                                                        text-align: start;">
                                                                    </textarea>
                                                                </div>

                                                                <div class="modal-footer">
                                                                    <button type="button" class="btn px-3"
                                                                        data-bs-dismiss="modal">Trở
                                                                        Lại</button> &nbsp; &nbsp;
                                                                    <button type="submit" id="submit"
                                                                        class="btn btn-danger px-3">Đánh
                                                                        Giá</button>
                                                                </div>
                                                            </form>
                                                            <div id="thank-you-message"
                                                                style="display: none; color: black; padding: 30px; font-size: 21px;"
                                                                class="text-center">
                                                                Cảm ơn bạn đã đánh giá sản phẩm!
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- end -->
                                            </section>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </aside>
                    </div>
                </header>
            </div>

            <div class="footer" th:replace="~{zlayout/footer :: footer}"></div>

        </div>

        <a href="#" class="top-home"><span><i class="bi bi-arrow-up-square-fill"></i></span></a>
    </div>

    <script src="/assets/js/jquery.min.js"></script>
    <script src="/assets/js/bootstrap.min.js"></script>
    <script src="/assets/js/bootstrap.bundle.min.js"></script>


    <script>
        // loading khi refresh
        var loader = function () {
            setTimeout(function () {
                $('#loader').css({ 'opacity': 0, 'visibility': 'hidden' });
            }, 1500);
        };
        $(function () {
            loader();
        });
        // end

        $(function () {
            $(window).scroll(function () {
                var scroll = $(window).scrollTop();
                if (scroll >= 1024) {
                    $(".navb").addClass("scrolled");
                } else {
                    $(".navb").removeClass("scrolled");
                }
            });
        });

        $(function () {
            $(".navbar-toggler").click(function () {
                $(".navbar-collapse").toggleClass("show");
            });
        });
        //


        // Đánh giá sao theo phần trăm
        // nhãn đánh giá
        const starLabels = {
            1: 'Tệ',
            2: 'Không hài lòng',
            3: 'Bình thường',
            4: 'Hài lòng',
            5: 'Tuyệt Vời'
        };
        // end

        const stars = document.querySelectorAll('.star');
        const ratingCount = document.querySelector('.rating-count');

        stars.forEach(star => {
            star.addEventListener('click', () => {
                const rating = parseInt(star.getAttribute('data-rating'));
                resetStars();
                setRating(rating);
                calculateAndDisplayPercentage(rating);
            });
        });

        function resetStars() {
            stars.forEach(star => star.classList.remove('selected'));
        }

        function setRating(rating) {
            for (let i = 0; i < rating; i++) {
                stars[i].classList.add('selected');
            }
            ratingCount.textContent = `${rating} sao`;
        }

        // chọn sao
        function calculateAndDisplayPercentage(rating) {
            const selectedStars = document.querySelectorAll('.star.selected').length;
            const totalStars = stars.length;
            const percentage = (selectedStars / totalStars) * 100;

            //Hiển thị phần trăm đã chọn ra ngoài

            // Hiển thị phần trăm đã chọn ra ngoài
            const percentageDisplay = document.getElementById('percentage-display');
            percentageDisplay.textContent = `Bạn đã đánh giá ${percentage}%`;

            if (percentage > 0) {
                const label = starLabels[rating.toString()];
                percentageDisplay.textContent = `Bạn đã đánh giá ${percentage}% - ${label}`;
                displayRatingLabel(label);
            } else {
                percentageDisplay.textContent = `Bạn đã đánh giá 0%`;
            }

        }

        document.getElementById('submit').addEventListener('click', function (event) {
            event.preventDefault(); // Ngăn chặn form gửi đi

            const selectedStars = document.querySelectorAll('.star.selected').length;
            if (selectedStars === 0) {
                // Hiển thị thông báo yêu cầu đánh giá sản phẩm
                alert('Vui lòng chọn số sao để đánh giá sản phẩm!');
            } else {
                const reviewSection = document.getElementById('modal-an');
                const thankYouMessage = document.getElementById('thank-you-message');

                // Ẩn phần đánh giá và hiển thị cảm ơn
                reviewSection.style.display = 'none'; // Ẩn phần đánh giá
                thankYouMessage.style.display = 'block'; // Hiển thị cảm ơn
            }
        });

        // end

    </script>
</body>

</html>